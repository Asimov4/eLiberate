{"version":3,"sources":["../../src/validate/servers.js"],"names":["validateServers","schema","object","keys","pattern","host","alternatives","string","trim","required","username","pem","password","opts","port","number","min","servers","details","result","validate","Object","forEach","server","key","indexOf","length","push","message","path"],"mappings":";;;;;kBAmBwBA,e;;AAnBxB;;AAEA;;;;;;AAEA;AACA,IAAMC,SAAS,cAAIC,MAAJ,GAAaC,IAAb,GAAoBC,OAApB,CAA4B,IAA5B,EAAkC;AAC/CC,QAAM,cACHC,YADG,CAEF,cAAIC,MAAJ,GAAaC,IAAb,EAFE,EAIHC,QAJG,EADyC;AAM/CC,YAAU,cAAIH,MAAJ,GAAaE,QAAb,EANqC;AAO/CE,OAAK,cAAIJ,MAAJ,GAAaC,IAAb,EAP0C;AAQ/CI,YAAU,cAAIL,MAAJ,EARqC;AAS/CM,QAAM,cAAIX,MAAJ,GAAaC,IAAb,CAAkB;AACtBW,UAAM,cAAIC,MAAJ;AADgB,GAAlB;AATyC,CAAlC,EAYZC,GAZY,CAYR,CAZQ,CAAf;;AAce,SAAShB,eAAT,CAAyBiB,OAAzB,EAAkC;AAC/C,MAAIC,UAAU,EAAd;AACA,MAAIC,SAAS,cAAIC,QAAJ,CAAaH,OAAb,EAAsBhB,MAAtB,0BAAb;AACAiB,YAAU,gCAAoBA,OAApB,EAA6BC,MAA7B,CAAV;;AAEAE,SAAOlB,IAAP,CAAYc,OAAZ,EAAqBK,OAArB,CAA6B,eAAO;AAClC,QAAMC,SAASN,QAAQO,GAAR,CAAf;AACA,QAAID,OAAOZ,GAAP,IAAcY,OAAOZ,GAAP,CAAWc,OAAX,CAAmB,MAAnB,MAA+BF,OAAOZ,GAAP,CAAWe,MAAX,GAAoB,CAArE,EAAwE;AACtER,cAAQS,IAAR,CAAa;AACXC,iBAAS,yFADE;AAEXC,cAASL,GAAT;AAFW,OAAb;AAID;AACF,GARD;;AAUA,SAAO,wBAAYN,OAAZ,EAAqB,SAArB,CAAP;AACD","file":"servers.js","sourcesContent":["import { VALIDATE_OPTIONS, addLocation, combineErrorDetails } from './utils';\n\nimport joi from 'joi';\n\n// The regexp used matches everything\nconst schema = joi.object().keys().pattern(/.*/, {\n  host: joi\n    .alternatives(\n      joi.string().trim()\n    )\n    .required(),\n  username: joi.string().required(),\n  pem: joi.string().trim(),\n  password: joi.string(),\n  opts: joi.object().keys({\n    port: joi.number()\n  })\n}).min(1);\n\nexport default function validateServers(servers) {\n  let details = [];\n  let result = joi.validate(servers, schema, VALIDATE_OPTIONS);\n  details = combineErrorDetails(details, result);\n\n  Object.keys(servers).forEach(key => {\n    const server = servers[key];\n    if (server.pem && server.pem.indexOf('.pub') === server.pem.length - 4) {\n      details.push({\n        message: 'Needs to be a path to a private key. The file extension \".pub\" is used for public keys.',\n        path: `${key}.pem`\n      });\n    }\n  });\n\n  return addLocation(details, 'servers');\n}\n"]}