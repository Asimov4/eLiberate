{"version":3,"sources":["../../src/validate/utils.js"],"names":["improveErrors","addLocation","combineErrorDetails","serversExist","VALIDATE_OPTIONS","abortEarly","convert","error","type","message","replace","details","location","map","detail","path","results","Array","concat","additionalDetails","serversConfig","serversUsed","messages","servers","Object","keys","using","forEach","indexOf","key","push"],"mappings":";;;;;QAKgBA,a,GAAAA,a;QAmBAC,W,GAAAA,W;QAWAC,mB,GAAAA,mB;QAUAC,Y,GAAAA,Y;AA7CT,IAAMC,8CAAmB;AAC9BC,cAAY,KADkB;AAE9BC,WAAS;AAFqB,CAAzB;;AAKA,SAASN,aAAT,CAAuBO,KAAvB,EAA8B;AACnC;AACA,MAAIA,MAAMC,IAAN,KAAe,qBAAnB,EAA0C;AACxCD,UAAME,OAAN,GAAgBF,MAAME,OAAN,CAAcC,OAAd,CACd,iBADc,EAEd,yBAFc,CAAhB;AAID,GALD,MAKO,IAAIH,MAAMC,IAAN,KAAe,gBAAnB,EAAqC;AAC1CD,UAAME,OAAN,GAAgBF,MAAME,OAAN,CAAcC,OAAd,CACd,gCADc,EAEd,OAFc,IAGZ,yBAHJ;AAID,GALM,MAKA,IAAIH,MAAMC,IAAN,KAAe,YAAnB,EAAiC;AACtCD,UAAME,OAAN,GAAgBF,MAAME,OAAN,CAAcC,OAAd,CAAsB,QAAtB,EAAgC,EAAhC,CAAhB;AACD;;AAED,SAAOH,KAAP;AACD;;AAEM,SAASN,WAAT,CAAqBU,OAArB,EAA8BC,QAA9B,EAAwC;AAC7C,SAAOD,QAAQE,GAAR,CAAY,kBAAU;AAC3B;AACA;AACAC,WAAOL,OAAP,GAAiBK,OAAOL,OAAP,CAAeC,OAAf,CAAuB,WAAvB,EAAoC,EAApC,CAAjB;;AAEAI,WAAOL,OAAP,SAAqBG,QAArB,SAAiCE,OAAOC,IAAxC,UAAiDD,OAAOL,OAAxD;AACA,WAAOK,MAAP;AACD,GAPM,CAAP;AAQD;;AAEM,SAASZ,mBAAT,CAA6BS,OAA7B,EAAsCK,OAAtC,EAA+C;AACpD,MAAIA,mBAAmBC,KAAvB,EAA8B;AAC5B,WAAON,QAAQO,MAAR,CAAeF,OAAf,CAAP;AACD;;AAED,MAAIG,oBAAoBH,QAAQT,KAAR,GAAgBS,QAAQT,KAAR,CAAcI,OAA9B,GAAwC,EAAhE;;AAEA,SAAOA,QAAQO,MAAR,CAAeC,iBAAf,CAAP;AACD;;AAEM,SAAShB,YAAT,GAA4D;AAAA,MAAtCiB,aAAsC,uEAAtB,EAAsB;AAAA,MAAlBC,WAAkB,uEAAJ,EAAI;;AACjE,MAAIC,WAAW,EAAf;AACA,MAAIC,UAAUC,OAAOC,IAAP,CAAYL,aAAZ,CAAd;AACA,MAAIM,QAAQF,OAAOC,IAAP,CAAYJ,WAAZ,CAAZ;AACAK,QAAMC,OAAN,CAAc,eAAO;AACnB,QAAIJ,QAAQK,OAAR,CAAgBC,GAAhB,MAAyB,CAAC,CAA9B,EAAiC;AAC/BP,eAASQ,IAAT,CAAc;AACZrB,8BAAoBoB,GAApB,qBADY;AAEZd,cAAM;AAFM,OAAd;AAID;AACF,GAPD;;AASA,SAAOO,QAAP;AACD","file":"utils.js","sourcesContent":["export const VALIDATE_OPTIONS = {\n  abortEarly: false,\n  convert: false\n};\n\nexport function improveErrors(error) {\n  // Todo: we can configure the joi messages instead of this\n  if (error.type === 'object.allowUnknown') {\n    error.message = error.message.replace(\n      ' is not allowed',\n      ' is an unknown property'\n    );\n  } else if (error.type === 'object.without') {\n    error.message = error.message.replace(\n      ' conflict with forbidden peer ',\n      ' and '\n    ) + ' cannot both be defined';\n  } else if (error.type === 'object.min') {\n    error.message = error.message.replace('.value', '');\n  }\n\n  return error;\n}\n\nexport function addLocation(details, location) {\n  return details.map(detail => {\n    // removes property name from message since it is\n    // already part of detail.path\n    detail.message = detail.message.replace(/^\".*?\"\\s+/, '');\n\n    detail.message = `\"${location}.${detail.path}\" ${detail.message}`;\n    return detail;\n  });\n}\n\nexport function combineErrorDetails(details, results) {\n  if (results instanceof Array) {\n    return details.concat(results);\n  }\n\n  let additionalDetails = results.error ? results.error.details : [];\n\n  return details.concat(additionalDetails);\n}\n\nexport function serversExist(serversConfig = {}, serversUsed = {}) {\n  let messages = [];\n  let servers = Object.keys(serversConfig);\n  let using = Object.keys(serversUsed);\n  using.forEach(key => {\n    if (servers.indexOf(key) === -1) {\n      messages.push({\n        message: `Server \"${key}\" doesn't exist`,\n        path: 'servers'\n      });\n    }\n  });\n\n  return messages;\n}\n"]}