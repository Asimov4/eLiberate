{"version":3,"sources":["../../src/__tests__/utils.unit.js"],"names":["utils","describe","it","list","taskList","executeScript","addStdioHandlers","run","sessions","opts","runCb","runTaskList","then","cb","_taskQueue","verbose","to","equal","undefined","copy","error","catch","needle","haystack","count","countOccurences","result","resolvePath","expected","resolve","indexOf"],"mappings":";;AAAA;;IAAYA,K;;AACZ;;;;AACA;;;;AACA;;AACA;;;;;;;;AAEAC,SAAS,OAAT,EAAkB,YAAW;AAC3BA,WAAS,kBAAT,EAA6B,YAAW;AACtCC,OAAG,kDAAH,EAAuD,YAAW;AAChE,UAAMC,OAAO,oBAAUC,QAAV,CAAmB,MAAnB,CAAb;AACAD,WAAKE,aAAL,CAAmB,SAAnB,EAA8B,EAA9B;AACA;AACAL,YAAMM,gBAAN,CAAuBH,IAAvB;AACD,KALD;AAMD,GAPD;;AASAF,WAAS,aAAT,EAAwB,YAAW;AACjCC,OAAG,wCAAH,EAA6C,cAAM;AACjD,UAAMC,OAAO;AACXI,WADW,eACPC,QADO,EACGC,IADH,EACSC,KADT,EACgB;AACzBA,gBAAM,EAAN;AACD;AAHU,OAAb;AAKAV,YAAMW,WAAN,CAAkBR,IAAlB,EAAwB,EAAxB,EAA4B,EAA5B,EAAgCS,IAAhC,CAAqC,YAAM;AAACC;AAAM,OAAlD;AACD,KAPD;;AASAX,OAAG,uCAAH,EAA4C,cAAM;AAChD,UAAMC,OAAO;AACXW,oBAAY,EADD;AAEXP,WAFW,eAEPC,QAFO,EAEGC,IAFH,EAESC,KAFT,EAEgB;AACzB,4BAAOD,KAAKM,OAAZ,EAAqBC,EAArB,CAAwBC,KAAxB,CAA8BC,SAA9B;AACAR,gBAAM,EAAN;AACD;AALU,OAAb;;AAQAV,YAAMW,WAAN,CAAkBR,IAAlB,EAAwB,EAAxB,EAA4B,EAACY,SAAS,IAAV,EAA5B,EACGH,IADH,CACQ,YAAM;AAAEC;AAAO,OADvB;AAED,KAXD;;AAaAX,OAAG,gCAAH,EAAqC,cAAM;AACzC,UAAMC,OAAO;AACXI,WADW,eACPC,QADO,EACGC,IADH,EACSC,KADT,EACgB;AACzBA,gBAAM;AACJS,kBAAM;AACJC,qBAAO;AADH;AADF,WAAN;AAKD;AAPU,OAAb;;AAUApB,YAAMW,WAAN,CAAkBR,IAAlB,EAAwB,EAAxB,EAA4B,EAA5B,EAAgCkB,KAAhC,CAAsC,YAAM;AAC1CR;AACD,OAFD;AAGD,KAdD;AAeD,GAtCD;;AAwCAZ,WAAS,iBAAT,EAA4B,YAAW;AACrCC,OAAG,iCAAH,EAAsC,YAAW;AAC/C,UAAMoB,SAAS,QAAf;AACA,UAAMC,WAAW,sIAAjB;AACA,UAAMC,QAAQxB,MAAMyB,eAAN,CAAsBH,MAAtB,EAA8BC,QAA9B,CAAd;AACA,4BAAOC,UAAU,CAAjB;AACD,KALD;AAMD,GAPD;;AASAvB,WAAS,aAAT,EAAwB,YAAW;AACjCC,OAAG,gCAAH,EAAqC,YAAW;AAC9C,UAAMwB,SAAS1B,MAAM2B,WAAN,CAAkB,OAAlB,EAA2B,QAA3B,CAAf;AACA,UAAMC,WAAW,eAAKC,OAAL,CAAa,OAAb,EAAsB,QAAtB,CAAjB;AACA,4BAAOH,WAAWE,QAAlB;AACD,KAJD;AAKA1B,OAAG,qBAAH,EAA0B,YAAW;AACnC,UAAMwB,SAAS1B,MAAM2B,WAAN,CAAkB,QAAlB,CAAf;AACA,4BAAOD,OAAOI,OAAP,CAAe,GAAf,MAAwB,CAAC,CAAhC;AACD,KAHD;AAID,GAVD;AAWD,CAtED","file":"utils.unit.js","sourcesContent":["import * as utils from '../utils';\nimport nodemiral from 'nodemiral';\nimport assert from 'assert';\nimport { expect } from 'chai';\nimport path from 'path';\n\ndescribe('utils', function() {\n  describe('addStdioHandlers', function() {\n    it('should add stdio handlers to nodemiral task list', function() {\n      const list = nodemiral.taskList('Test');\n      list.executeScript('testing', {});\n      // Test that it doesn't throw an error\n      utils.addStdioHandlers(list);\n    });\n  });\n\n  describe('runTaskList', function() {\n    it('should resolve when list is sucessfull', cb => {\n      const list = {\n        run(sessions, opts, runCb) {\n          runCb({});\n        }\n      };\n      utils.runTaskList(list, {}, {}).then(() => {cb();});\n    });\n\n    it('should add stdio handlers for verbose', cb => {\n      const list = {\n        _taskQueue: [],\n        run(sessions, opts, runCb) {\n          expect(opts.verbose).to.equal(undefined);\n          runCb({});\n        }\n      };\n\n      utils.runTaskList(list, {}, {verbose: true})\n        .then(() => { cb(); });\n    });\n\n    it('should reject if a task failed', cb => {\n      const list = {\n        run(sessions, opts, runCb) {\n          runCb({\n            copy: {\n              error: 'error'\n            }\n          });\n        }\n      };\n\n      utils.runTaskList(list, {}, {}).catch(() => {\n        cb();\n      });\n    });\n  });\n\n  describe('countOccurences', function() {\n    it('should return the correct count', function() {\n      const needle = 'Meteor';\n      const haystack = 'Production Quality Meteor Deployments. Meteor Up is a command line tool that allows you to deploy any Meteor app to your own server.';\n      const count = utils.countOccurences(needle, haystack);\n      assert(count === 3);\n    });\n  });\n\n  describe('resolvePath', function() {\n    it('should return the correct path', function() {\n      const result = utils.resolvePath('/root', '../opt');\n      const expected = path.resolve('/root', '../opt');\n      assert(result === expected);\n    });\n    it('should expand tilde', function() {\n      const result = utils.resolvePath('~/.ssh');\n      assert(result.indexOf('~') === -1);\n    });\n  });\n});\n"]}